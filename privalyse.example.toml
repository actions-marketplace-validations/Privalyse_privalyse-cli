# Privalyse Configuration Example
# Rename this file to 'privalyse.toml' to activate it.

[policy]
# Block data flows to specific countries (ISO 3166-1 alpha-2 codes)
# Example: Block transfers to US and China due to data sovereignty concerns
blocked_countries = ["US", "CN", "RU"]

# Block specific providers/sinks
# Available providers: "openai", "aws", "azure", "gcp", "anthropic", "cohere"
# Example: Block OpenAI if you only want to use local models
blocked_providers = ["openai"]

# Require sanitization (e.g. anonymize(), hash()) before sending PII to AI models
# If true, sending raw PII to an AI sink will be a CRITICAL finding.
require_sanitization_for_ai = true

[scanner]
# Ignore specific directories (glob patterns)
ignore_patterns = [
    "tests/**",
    "venv/**",
    "**/node_modules/**",
    "dist/**"
]

# Customize severity levels for specific rules
[severity]
HARDCODED_SECRET = "CRITICAL"
PII_LEAK = "HIGH"
AI_PII_LEAK = "CRITICAL"


# =============================================================================
# CUSTOM RULES
# Define your own detection rules using regex patterns.
# These are merged with the built-in rules (built-ins always run).
# =============================================================================

# Example: Detect internal company tokens
[[rules]]
id = "INTERNAL_TOKEN"
pattern = "ACME-[A-Z0-9]{10}"
severity = "critical"
message = "Internal ACME token detected - these should never be in code"
category = "secret"

# Example: Detect debug flags in production code
[[rules]]
id = "DEBUG_FLAG"
pattern = "DEBUG\\s*=\\s*True"
severity = "medium"
message = "Debug flag enabled - ensure this is disabled in production"
file_patterns = ["*.py"]
exclude_patterns = ["*_test.py", "test_*.py", "conftest.py"]

# Example: Detect TODO comments with sensitive keywords
[[rules]]
id = "TODO_SECURITY"
pattern = "TODO.*(password|secret|key|token|credential)"
severity = "low"
message = "TODO comment mentions sensitive data - review before merging"

# Example: Detect hardcoded localhost URLs (potential dev leftovers)
[[rules]]
id = "LOCALHOST_URL"
pattern = "https?://localhost:[0-9]+"
severity = "low"
message = "Hardcoded localhost URL - ensure this is intentional"
exclude_patterns = ["*.test.*", "*_test.py"]
